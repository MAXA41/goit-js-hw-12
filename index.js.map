{"version":3,"file":"index.js","sources":["../src/js/render-functions.js","../src/js/pixabay-api.js","../src/main.js"],"sourcesContent":["import SimpleLightbox from 'simplelightbox';\r\nimport 'simplelightbox/dist/simple-lightbox.min.css';\r\n\r\nconst gallery = document.querySelector('.gallery');\r\nconst loader = document.querySelector('.loader');\r\nconst loadMore = document.querySelector('.load-btn');\r\n\r\nconst lightbox = new SimpleLightbox('.gallery a', {\r\n  captionsData: 'alt',\r\n  captionDelay: 250,\r\n});\r\n\r\nexport function createGallery(images) {\r\n  const markup = images\r\n    .map(\r\n      ({\r\n        webformatURL,\r\n        largeImageURL,\r\n        tags,\r\n        likes,\r\n        views,\r\n        comments,\r\n        downloads,\r\n      }) => `<li class=\"gallery-item\">\r\n  <a class=\"gallery-link\" href=\"${largeImageURL}\">\r\n    <img\r\n      class=\"gallery-image\"\r\n      src=\"${webformatURL}\"\r\n      alt=\"${tags}\"\r\n    />\r\n    <ul class=\"gallery-info\">\r\n      <li class=\"info-item\">\r\n        <h3 class=\"title\">Likes</h3>\r\n        <p class=\"info\">${likes}</p>\r\n      </li>\r\n      <li class=\"info-item\">\r\n        <h3 class=\"title\">Views</h3>\r\n        <p class=\"info\">${views}</p>\r\n      </li>\r\n      <li class=\"info-item\">\r\n        <h3 class=\"title\">Comments</h3>\r\n        <p class=\"info\">${comments}</p>\r\n      </li>\r\n      <li class=\"info-item\">\r\n        <h3 class=\"title\">Downloads</h3>\r\n        <p class=\"info\">${downloads}</p>\r\n      </li>\r\n    </ul>\r\n  </a>\r\n</li>\r\n`\r\n    )\r\n    .join('');\r\n\r\n  gallery.insertAdjacentHTML('beforeend', markup);\r\n\r\n  //   const link = document\r\n  //     .querySelector('.gallery-link')\r\n  //     .addEventListener('click', event => event.preventDefault());\r\n\r\n  lightbox.refresh();\r\n}\r\n\r\nexport function clearGallery() {\r\n  gallery.innerHTML = '';\r\n}\r\n\r\nexport function showLoader() {\r\n  loader.classList.add('visible');\r\n}\r\n\r\nexport function hideLoader() {\r\n  loader.classList.remove('visible');\r\n}\r\n\r\nexport function showLoadMoreButton() {\r\n  loadMore.classList.add('btn-visible');\r\n}\r\n\r\nexport function hideLoadMoreButton() {\r\n  loadMore.classList.remove('btn-visible');\r\n}\r\n\r\n//     ----------------------  lightbox\r\n\r\n// let lightbox = null;\r\n\r\n// export function initLightbox() {\r\n//   lightbox = new SimpleLightbox('.gallery a', {\r\n//     captionsData: 'alt',\r\n//     captionDelay: 250,\r\n//   });\r\n// }\r\n\r\n// export function refreshLightbox() {\r\n//   if (lightbox) lightbox.refresh();\r\n// }\r\n","import axios from 'axios';\r\nimport iziToast from 'izitoast';\r\nimport { createGallery, hideLoader } from './render-functions';\r\n\r\nconst API_KEY = '49830885-3c4fb55cab3b8487f16091a9c';\r\n// axios.defaults.baseURL = 'https://pixabay.com/api/';\r\n\r\nexport const getImagesByQuery = async (query, page) => {\r\n  const response = await axios.get('https://pixabay.com/api/', {\r\n    params: {\r\n      key: API_KEY,\r\n      q: query,\r\n      image_type: 'photo',\r\n      orientation: 'horizontal',\r\n      safesearch: true,\r\n      per_page: 15,\r\n      page: page,\r\n    },\r\n  });\r\n  const total = response.data.totalHits;\r\n  const pictures = response.data.hits;\r\n  return { pictures, total };\r\n};\r\n","// Описаний у документації\r\nimport iziToast from 'izitoast';\r\n// Додатковий імпорт стилів\r\nimport 'izitoast/dist/css/iziToast.min.css';\r\n\r\nimport { getImagesByQuery } from './js/pixabay-api';\r\nimport {\r\n  createGallery,\r\n  clearGallery,\r\n  showLoader,\r\n  hideLoader,\r\n  showLoadMoreButton,\r\n  hideLoadMoreButton,\r\n} from './js/render-functions';\r\n\r\nconst inp = document.querySelector('.inp');\r\nconst form = document.querySelector('.form');\r\nconst loadMore = document.querySelector('.load-btn');\r\n\r\nlet queryVal = '';\r\nlet page = 1;\r\nlet totalPages;\r\nlet card;\r\nlet cardSize;\r\n\r\nconst submit = form.addEventListener('submit', async event => {\r\n  event.preventDefault();\r\n  queryVal = inp.value.trim();\r\n  page = 1;\r\n  \r\n  if (queryVal === '') {\r\n    iziToast.warning({\r\n      title: 'Warning',\r\n      message: 'Search field cannot be empty.',\r\n      position: 'topRight',\r\n    });\r\n    clearGallery();\r\n    hideLoadMoreButton();\r\n    form.reset();\r\n    return;\r\n  }\r\n\r\n  clearGallery();\r\n  hideLoadMoreButton();\r\n  showLoader();\r\n\r\n  try {\r\n    const { pictures, total } = await getImagesByQuery(queryVal, page);\r\n\r\n    if (pictures.length === 0) {\r\n      iziToast.error({\r\n        title: 'Error',\r\n        message: 'Sorry, there are no images matching your search query. Please try again!',\r\n        position: 'topRight',\r\n      });\r\n      return;\r\n    }\r\n    \r\n    createGallery(pictures);\r\n    totalPages = Math.ceil(total / 15);\r\n\r\n    // Показуємо кнопку тільки якщо є ще сторінки\r\n    if (page < totalPages) {\r\n      showLoadMoreButton();\r\n    }\r\n\r\n    // Отримуємо розмір картки для подальшого скролу\r\n    card = document.querySelector('.gallery-item');\r\n    if (card) {\r\n      cardSize = card.getBoundingClientRect();\r\n    }\r\n  } catch (error) {\r\n    iziToast.error({\r\n      title: 'Error',\r\n      message: `${error}`,\r\n      position: 'topRight',\r\n    });\r\n  } finally {\r\n    hideLoader();\r\n    form.reset();\r\n  }\r\n});\r\n\r\nconst loadBtn = loadMore.addEventListener('click', async () => {\r\n  // Перевіряємо чи є ще сторінки\r\n  if (page >= totalPages) {\r\n    iziToast.info({\r\n      title: 'Oops',\r\n      message: `We're sorry, but you've reached the end of search results.`,\r\n      position: 'topRight',\r\n    });\r\n    hideLoadMoreButton();\r\n    return;\r\n  }\r\n\r\n  page += 1;\r\n  showLoader();\r\n\r\n  try {\r\n    // Виправлено: передаємо queryVal та page\r\n    const { pictures } = await getImagesByQuery(queryVal, page);\r\n    createGallery(pictures);\r\n\r\n    // Плавний скрол\r\n    if (cardSize) {\r\n      window.scrollBy({\r\n        top: cardSize.height * 2,\r\n        behavior: 'smooth',\r\n      });\r\n    }\r\n\r\n    // Ховаємо кнопку, якщо досягли кінця\r\n    if (page >= totalPages) {\r\n      iziToast.info({\r\n        title: 'Info',\r\n        message: `You've reached the end of search results.`,\r\n        position: 'topRight',\r\n      });\r\n      hideLoadMoreButton();\r\n    }\r\n  } catch (error) {\r\n    iziToast.error({\r\n      title: 'Error',\r\n      message: `${error}`,\r\n      position: 'topRight',\r\n    });\r\n  } finally {\r\n    hideLoader();\r\n  }\r\n});"],"names":["gallery","loader","loadMore","lightbox","SimpleLightbox","createGallery","images","markup","webformatURL","largeImageURL","tags","likes","views","comments","downloads","clearGallery","showLoader","hideLoader","showLoadMoreButton","hideLoadMoreButton","API_KEY","getImagesByQuery","query","page","response","axios","total","inp","form","queryVal","totalPages","card","cardSize","event","iziToast","pictures","error"],"mappings":"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"}